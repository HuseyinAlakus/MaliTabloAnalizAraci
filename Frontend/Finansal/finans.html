<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finansal Analiz</title>
    <link rel="stylesheet" href="finans.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body>
    <div class="navbar">
        <!-- Geri Git Butonu (Sol Üst) -->
        <a href="../Hizmetler Sayfası/services.html" class="back-btn"><i class="fas fa-arrow-left"></i> Hizmetler</a>
        
        <div class="right-links">
            <a href="../AnaSayfa/home.html" class="logo"><i class="fas fa-home"></i></a>
            <a href="../AnaSayfa/home.html">Ana Sayfa</a>
        </div>
    </div>

    <div class="container">
        <h1>Finansal Analiz</h1>
        <div class="upload-section">
            <h2>CSV Dosyanızı Yükleyin</h2>
            <input type="file" id="fileInput" accept=".csv">
            <button class="btn" onclick="handleFileUpload()">Yükle</button>
        </div>
        <div class="results" id="results">
            <h2>Analiz Sonuçları</h2>
            <p>Burada finansal analiz sonuçları görüntülenecek.</p>
        </div>
    </div>
            <script>
        async function handleFileUpload() {
            const fileInput = document.getElementById('fileInput');
            const resultsDiv = document.getElementById('results');

            if (fileInput.files.length === 0) {
                alert("Lütfen bir dosya seçin.");
                return;
            }

            const file = fileInput.files[0];
            const formData = new FormData();
            formData.append("file", file);

            resultsDiv.innerHTML = "<p>Dosya yükleniyor, lütfen bekleyin...</p>";

            try {
                const response = await fetch("http://127.0.0.1:5000/analyze", {
                    method: "POST",
                    body: formData
                });

                const data = await response.json();

                resultsDiv.innerHTML = "<h2>Yapay Zeka Yorumları</h2>";

                if (!data.results || data.results.length === 0) {
                    resultsDiv.innerHTML += "<p>Herhangi bir analiz sonucu alınamadı.</p>";
                    return;
                }

                // Yorumları listele
                data.results.forEach(item => {
                    resultsDiv.innerHTML += `
                        <div style="border:1px solid #ccc; padding:10px; margin:10px 0;">
                            <strong>${item.oran}</strong><br>
                            ${item.yorum}
                        </div>
                    `;
                });

                // Genel yorum varsa göster
                if (data.genel_yorum) {
                    resultsDiv.innerHTML += `
                        <div style="border:2px solid #ffd700; padding:15px; margin:20px 0; background:#fffbe6;">
                            <strong>Genel Yapay Zeka Yorumu:</strong><br>
                            <span>${data.genel_yorum}</span>
                        </div>
                    `;
                }

            } catch (error) {
                resultsDiv.innerHTML = `<p style="color:red;">Hata oluştu: ${error.message}</p>`;
            }
        }
    </script>



</body>
</html>
